<!DOCTYPE html>
<html lang="English">
<head>
    <link rel="stylesheet" type="text/css" href="styles.p1.css">
    <style>
        table,th,td {
            border : 1px solid black;
            border-collapse: collapse;
        }
        th,td {
            padding: 5px;
        }
    </style>
    <title>Homework 8 - AJAX Application</title>
</head>

<body>
    <h1>Homework 8 - AJAX Application</h1>
<button type="button" onclick="loadDoc()">Get CD collection</button>
<br><br>
<table id="demo"></table>
<script>
function loadDoc() {
  const xhttp = new XMLHttpRequest();
  xhttp.onload = function() {
    myFunction(this);
  }
  xhttp.open("GET", "cd_catalog.xml");
  xhttp.send();
}
function myFunction(xml) {
  const xmlDoc = xml.responseXML;
  const x = xmlDoc.getElementsByTagName("CD");
  let table="<tr><th>Artist</th><th>Title</th></tr>";
  for (let i = 0; i <x.length; i++) { 
    table += "<tr><td>" +
    x[i].getElementsByTagName("ARTIST")[0].childNodes[0].nodeValue +
    "</td><td>" +
    x[i].getElementsByTagName("TITLE")[0].childNodes[0].nodeValue +
    "</td></tr>";
  }
  document.getElementById("demo").innerHTML = table;
}
</script>
<h2>Explanation of AJAX</h2>
    <p>
        The JavaScript contains two functions detailed below:
    </p>
    <p>
        The loadDoc() function employs the XMLHttpRequest object 'xhttp' to handle the communication with the server. The function first creates a new XMLHttpRequest object (xhttp), then defines the onload event to call myFunction, then open a GET request for the specified XML file. The onload event executes myFunction() when the request is successfully completed. It initiates an asynchronous HTTP request to retrieve an XML document named "cd_catalog.xml." Finally, it sends the HTTP request via send(), initiating the retrieval process.
    </p>
    <p>
        The myFunction(xml) function is designed to process the XML data received in response to the XMLHttpRequest. It takes an XML parameter (xml) representing the response. Inside the function, it extracts the XML document (xmlDoc) from the response. Subsequently, it retrieves all elements with the tag name "CD" from the XML document. The function then constructs an HTML table (table) with headers for "Artist" and "Title." It iterates through each "CD" element, extracting the values for "ARTIST" and "TITLE," and appends corresponding rows to the HTML table. Finally, it obtains the element with id="demo" and inserts the modified table into the element.
    </p>

<h2>REST API</h2>

<nav>
    <a href="index.html">Main</a>
</nav>
</body>
</html>